# 부록

## 부록 A. 예제 코드 목록

### Chapter 04: 첫 번째 UI 자동화 테스트

| 예제 | 경로 | 설명 |
|------|------|------|
| **계산기 테스트** | [examples/Chapter04.Calculator](../../examples/Chapter04.Calculator/) | WinAppDriver를 사용한 계산기 앱 자동화 |
| **메모장 테스트** | [examples/Chapter04.Notepad](../../examples/Chapter04.Notepad/) | 메모장 앱 자동화 및 다이얼로그 처리 |

### Chapter 06: FlaUI 활용

| 예제 | 경로 | 설명 |
|------|------|------|
| **FlaUI 계산기** | [examples/Chapter06.FlaUI](../../examples/Chapter06.FlaUI/) | FlaUI를 사용한 네이티브 자동화 |

### Chapter 08: Page Object Model

| 예제 | 경로 | 설명 |
|------|------|------|
| **POM 패턴** | [examples/Chapter08.PageObjectModel](../../examples/Chapter08.PageObjectModel/) | Page Object Model 패턴 구현 |

---

## 부록 B. 핵심 키워드 및 참조 링크

### UI Automation 기초

| 키워드 | 설명 | 참조 링크 |
|--------|------|----------|
| **UI Automation** | Windows 접근성 및 자동화 프레임워크 | [Microsoft Docs](https://learn.microsoft.com/ko-kr/dotnet/framework/ui-automation/ui-automation-overview) |
| **AutomationElement** | UI 요소의 추상 표현 | [Microsoft Docs](https://learn.microsoft.com/ko-kr/dotnet/api/system.windows.automation.automationelement) |
| **Control Patterns** | 컨트롤의 상호작용 방식 정의 | [Microsoft Docs](https://learn.microsoft.com/ko-kr/dotnet/framework/ui-automation/ui-automation-control-patterns-overview) |
| **InvokePattern** | 버튼 클릭 패턴 | [Microsoft Docs](https://learn.microsoft.com/ko-kr/dotnet/api/system.windows.automation.invokepattern) |
| **ValuePattern** | 값 설정/가져오기 패턴 | [Microsoft Docs](https://learn.microsoft.com/ko-kr/dotnet/api/system.windows.automation.valuepattern) |
| **SelectionPattern** | 항목 선택 패턴 | [Microsoft Docs](https://learn.microsoft.com/ko-kr/dotnet/api/system.windows.automation.selectionpattern) |
| **TextPattern** | 텍스트 조작 패턴 | [Microsoft Docs](https://learn.microsoft.com/ko-kr/dotnet/api/system.windows.automation.textpattern) |
| **TogglePattern** | 체크박스 토글 패턴 | [Microsoft Docs](https://learn.microsoft.com/ko-kr/dotnet/api/system.windows.automation.togglepattern) |
| **WindowPattern** | 창 조작 패턴 | [Microsoft Docs](https://learn.microsoft.com/ko-kr/dotnet/api/system.windows.automation.windowpattern) |

### .NET 및 Windows 플랫폼

| 키워드 | 설명 | 참조 링크 |
|--------|------|----------|
| **WPF** | Windows Presentation Foundation | [Microsoft Docs](https://learn.microsoft.com/ko-kr/dotnet/desktop/wpf/) |
| **WinForms** | Windows Forms | [Microsoft Docs](https://learn.microsoft.com/ko-kr/dotnet/desktop/winforms/) |
| **UWP** | Universal Windows Platform | [Microsoft Docs](https://learn.microsoft.com/ko-kr/windows/uwp/) |
| **Windows App SDK** | 최신 Windows 앱 프레임워크 | [Microsoft Docs](https://learn.microsoft.com/ko-kr/windows/apps/windows-app-sdk/) |
| **.NET MAUI** | Multi-platform App UI | [Microsoft Docs](https://learn.microsoft.com/ko-kr/dotnet/maui/) |

### 테스트 프레임워크

| 키워드 | 설명 | 참조 링크 |
|--------|------|----------|
| **xUnit** | 현대적인 .NET 테스트 프레임워크 | [xUnit.net](https://xunit.net/) |
| **NUnit** | 인기 있는 오픈소스 테스트 프레임워크 | [NUnit.org](https://nunit.org/) |
| **MSTest** | Microsoft 공식 테스트 프레임워크 | [Microsoft Docs](https://learn.microsoft.com/ko-kr/dotnet/core/testing/unit-testing-with-mstest) |

### UI 자동화 도구

| 키워드 | 설명 | 참조 링크 |
|--------|------|----------|
| **WinAppDriver** | Windows Application Driver | [GitHub](https://github.com/Microsoft/WinAppDriver) |
| **FlaUI** | .NET 기반 UI Automation 라이브러리 | [GitHub](https://github.com/FlaUI/FlaUI) |
| **Appium** | 크로스 플랫폼 모바일 자동화 | [Appium.io](http://appium.io/) |
| **Selenium** | 웹 자동화 표준 | [Selenium.dev](https://www.selenium.dev/) |
| **Playwright** | 현대적인 웹 자동화 | [Playwright.dev](https://playwright.dev/) |

### 개발 도구

| 키워드 | 설명 | 참조 링크 |
|--------|------|----------|
| **Visual Studio** | Microsoft IDE | [Visual Studio](https://visualstudio.microsoft.com/ko/) |
| **.NET SDK** | .NET 소프트웨어 개발 키트 | [.NET Downloads](https://dotnet.microsoft.com/ko-kr/download) |
| **Inspect.exe** | UI Automation 요소 검사 도구 | [Microsoft Docs](https://learn.microsoft.com/ko-kr/windows/win32/winauto/inspect-objects) |

### 접근성

| 키워드 | 설명 | 참조 링크 |
|--------|------|----------|
| **Accessibility** | Windows 접근성 | [Microsoft Docs](https://learn.microsoft.com/ko-kr/windows/apps/design/accessibility/accessibility-overview) |
| **WCAG** | Web Content Accessibility Guidelines | [W3C](https://www.w3.org/WAI/WCAG21/quickref/) |
| **Axe-Windows** | 접근성 자동 테스트 도구 | [GitHub](https://github.com/microsoft/axe-windows) |

### CI/CD

| 키워드 | 설명 | 참조 링크 |
|--------|------|----------|
| **Azure DevOps** | Microsoft CI/CD 플랫폼 | [Azure DevOps](https://learn.microsoft.com/ko-kr/azure/devops/) |
| **GitHub Actions** | GitHub CI/CD | [GitHub Docs](https://docs.github.com/en/actions) |

### 디자인 패턴

| 키워드 | 설명 | 참조 링크 |
|--------|------|----------|
| **Page Object Model** | UI 테스트 디자인 패턴 | [Martin Fowler](https://martinfowler.com/bliki/PageObject.html) |
| **Test Pyramid** | 테스트 전략 모델 | [Martin Fowler](https://martinfowler.com/bliki/TestPyramid.html) |

---

## 부록 C. NuGet 패키지 레퍼런스

### UI 자동화 핵심 패키지

```xml
<!-- FlaUI -->
<PackageReference Include="FlaUI.Core" Version="4.0.0" />
<PackageReference Include="FlaUI.UIA3" Version="4.0.0" />

<!-- WinAppDriver -->
<PackageReference Include="Appium.WebDriver" Version="5.0.0-rc.1" />
<PackageReference Include="Selenium.WebDriver" Version="4.16.2" />

<!-- 테스트 프레임워크 -->
<PackageReference Include="Microsoft.NET.Test.Sdk" Version="17.8.0" />
<PackageReference Include="xunit" Version="2.6.4" />
<PackageReference Include="xunit.runner.visualstudio" Version="2.5.6" />
```

### 유틸리티 패키지

```xml
<!-- 로깅 -->
<PackageReference Include="Serilog" Version="3.1.1" />
<PackageReference Include="Serilog.Sinks.Console" Version="5.0.1" />
<PackageReference Include="Serilog.Sinks.File" Version="5.0.0" />

<!-- Retry 메커니즘 -->
<PackageReference Include="Polly" Version="8.2.0" />

<!-- Assertion 확장 -->
<PackageReference Include="FluentAssertions" Version="6.12.0" />

<!-- 데이터 처리 -->
<PackageReference Include="CsvHelper" Version="30.0.1" />
<PackageReference Include="Newtonsoft.Json" Version="13.0.3" />
```

---

## 부록 D. 체크리스트

### 테스트 환경 구성 체크리스트

- [ ] Visual Studio 2022 설치
- [ ] .NET 8.0 SDK 설치
- [ ] Windows 개발자 모드 활성화
- [ ] WinAppDriver 설치 (선택사항)
- [ ] Inspect.exe 사용 가능 확인
- [ ] 테스트 프로젝트 생성
- [ ] NuGet 패키지 설치

### 테스트 케이스 설계 체크리스트

- [ ] 테스트 목적 명확히 정의
- [ ] Given-When-Then 구조 사용
- [ ] 테스트 데이터 준비
- [ ] 예상 결과 정의
- [ ] Setup/Teardown 구현
- [ ] 적절한 Assertion 사용
- [ ] 에러 메시지 의미 있게 작성

### 코드 리뷰 체크리스트

- [ ] 명확한 테스트 메서드 이름
- [ ] DRY 원칙 준수 (중복 코드 제거)
- [ ] Page Object 패턴 적용
- [ ] 적절한 대기 시간 사용
- [ ] 하드코딩된 값 최소화
- [ ] Exception 처리 적절히 구현
- [ ] 주석으로 복잡한 로직 설명

### 배포 전 체크리스트

- [ ] 모든 테스트 통과
- [ ] Flaky 테스트 제거 또는 수정
- [ ] CI/CD 파이프라인 정상 동작
- [ ] 테스트 실행 시간 허용 범위 내
- [ ] 테스트 리포트 생성 확인
- [ ] 실패 시 스크린샷 캡처 동작
- [ ] 로그 파일 정상 생성

---

## 부록 E. 코드 스니펫

### Base Test 클래스 템플릿

```csharp
using FlaUI.Core;
using FlaUI.Core.AutomationElements;
using FlaUI.UIA3;
using Xunit;

public abstract class TestBase : IDisposable
{
    protected Application App { get; private set; }
    protected UIA3Automation Automation { get; private set; }
    protected Window MainWindow { get; private set; }

    protected TestBase(string appPath)
    {
        App = Application.Launch(appPath);
        Automation = new UIA3Automation();
        MainWindow = App.GetMainWindow(Automation);
    }

    protected void TakeScreenshot(string filename)
    {
        var screenshot = FlaUI.Core.Capturing.Capture.Screen();
        screenshot.ToFile($"screenshots/{filename}.png");
    }

    public virtual void Dispose()
    {
        try
        {
            App?.Close();
        }
        catch
        {
            App?.Kill();
        }
        finally
        {
            Automation?.Dispose();
        }
    }
}
```

### Retry Helper

```csharp
public static class RetryHelper
{
    public static T Retry<T>(Func<T> action, int maxAttempts = 3, int delayMs = 1000)
    {
        Exception lastException = null;

        for (int i = 0; i < maxAttempts; i++)
        {
            try
            {
                return action();
            }
            catch (Exception ex)
            {
                lastException = ex;
                if (i < maxAttempts - 1)
                {
                    Thread.Sleep(delayMs * (i + 1));
                }
            }
        }

        throw new Exception($"Operation failed after {maxAttempts} attempts", lastException);
    }
}
```

### Wait Helper

```csharp
using FlaUI.Core.AutomationElements;
using FlaUI.Core.Definitions;

public static class WaitHelper
{
    public static void WaitUntilEnabled(AutomationElement element, int timeoutSeconds = 10)
    {
        var endTime = DateTime.Now.AddSeconds(timeoutSeconds);

        while (DateTime.Now < endTime)
        {
            if (element.IsEnabled)
                return;

            Thread.Sleep(500);
        }

        throw new TimeoutException($"Element did not become enabled within {timeoutSeconds} seconds");
    }

    public static void WaitUntilVisible(AutomationElement element, int timeoutSeconds = 10)
    {
        var endTime = DateTime.Now.AddSeconds(timeoutSeconds);

        while (DateTime.Now < endTime)
        {
            if (!element.IsOffscreen)
                return;

            Thread.Sleep(500);
        }

        throw new TimeoutException($"Element did not become visible within {timeoutSeconds} seconds");
    }
}
```

---

## 부록 F. 트러블슈팅 FAQ

### Q: WinAppDriver 연결 실패 (Cannot start the driver service)

**A:**
1. WinAppDriver.exe가 실행 중인지 확인
2. 개발자 모드가 활성화되어 있는지 확인
3. 방화벽 설정 확인
4. 포트 4723이 다른 프로세스에서 사용 중인지 확인

### Q: 요소를 찾을 수 없음 (NoSuchElementException)

**A:**
1. Inspect.exe로 요소의 실제 속성 확인
2. 암시적/명시적 대기 시간 증가
3. AutomationId가 고유한지 확인
4. 요소가 실제로 표시되는지 확인 (IsOffscreen 속성)

### Q: 테스트가 불안정함 (Flaky Tests)

**A:**
1. 적절한 대기 메커니즘 사용
2. 타이밍 의존성 제거
3. 테스트 데이터 격리
4. 애니메이션 완료 대기

### Q: 테스트 실행이 너무 느림

**A:**
1. 불필요한 대기 시간 제거
2. 병렬 실행 활용
3. Setup/Teardown 최적화
4. 선택적 테스트 실행

---

## 부록 G. 참고 도서 및 리소스

### 추천 도서

1. **Test-Driven Development with C# and .NET** by Roy Osherove
2. **Continuous Delivery** by Jez Humble, David Farley
3. **The Art of Unit Testing** by Roy Osherove

### 온라인 리소스

- [Microsoft Learn - UI Automation](https://learn.microsoft.com/ko-kr/dotnet/framework/ui-automation/)
- [FlaUI Wiki](https://github.com/FlaUI/FlaUI/wiki)
- [WinAppDriver Documentation](https://github.com/Microsoft/WinAppDriver)
- [Martin Fowler's Blog](https://martinfowler.com/)

### 커뮤니티

- [Stack Overflow - winappdriver tag](https://stackoverflow.com/questions/tagged/winappdriver)
- [Stack Overflow - flaui tag](https://stackoverflow.com/questions/tagged/flaui)
- [GitHub Discussions - FlaUI](https://github.com/FlaUI/FlaUI/discussions)

---

## 요약

이 부록에서는 다음 내용을 제공합니다:

- **부록 A**: 예제 코드 목록 및 위치
- **부록 B**: 핵심 키워드 및 참조 링크 집계
- **부록 C**: NuGet 패키지 레퍼런스
- **부록 D**: 실전 체크리스트
- **부록 E**: 재사용 가능한 코드 스니펫
- **부록 F**: 트러블슈팅 FAQ
- **부록 G**: 추가 학습 리소스

[◀ 이전: 제23장](../part3/chapters-09-to-23.md) | [목차로 ▶](../../README.md)
